
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><title>Resources</title><link href="browser.css" type="text/css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><script type="text/javascript" src="js/common.js"></script><script type="text/javascript">var oListManager=new Object();oListManager.Clear=function(){document.body.innerHTML=""};function ProtectPath(a){a=a.replace(/\\/g,"\\\\");a=a.replace(/'/g,"\\'");return a}oListManager.GetFolderRowHtml=function(c,b){var a='<a href="#" onclick="OpenFolder(\'' + ProtectPath(folderPath) + '\');return false;">';return'<tr><td width="16">'+a+'<img alt="" src="images/Folder.gif" width="16" height="16" border="0"></a></td><td nowrap colspan="2">&nbsp;'+a+c+"</a></td></tr>"};oListManager.GetFileRowHtml=function(e,c,b){var a='<a href="#" onclick="OpenFile(\'' + ProtectPath(fileUrl) + '\');return false;">';var d=oIcons.GetIcon(e);return'<tr><td width="16">'+a+'<img alt="" src="images/icons/'+d+'.gif" width="16" height="16" border="0"></a></td><td>&nbsp;'+a+e+'</a></td><td align="right" nowrap>&nbsp;'+b+" KB</td></tr>"};function OpenFolder(a){window.parent.frames.frmFolders.LoadFolders(a)}function OpenFile(a){window.top.opener.SetUrl(a);window.top.close();window.top.opener.focus()}function LoadResources(b,a){oListManager.Clear();oConnector.ResourceType=b;oConnector.CurrentFolder=a;oConnector.SendCommand("GetFoldersAndFiles",null,GetFoldersAndFilesCallBack)}function Refresh(){LoadResources(oConnector.ResourceType,oConnector.CurrentFolder)}function GetFoldersAndFilesCallBack(e){if(oConnector.CheckError(e)!=0){return}var d=e.SelectSingleNode("Connector/CurrentFolder");if(d==null){alert("The server didn't reply with a proper XML data. Please check your configuration.");return}var n=d.attributes.getNamedItem("path").value;var f=d.attributes.getNamedItem("url").value;var c=new StringBuilder('<table id="tableFiles" cellspacing="1" cellpadding="0" width="100%" border="0">');var o;o=e.SelectNodes("Connector/Folders/Folder");for(var h=0;h<o.length;h++){var a=o[h].attributes.getNamedItem("name").value;c.Append(oListManager.GetFolderRowHtml(a,n+a+"/"))}o=e.SelectNodes("Connector/Files/File");for(var g=0;g<o.length;g++){var p=o[g];var l=p.attributes.getNamedItem("name").value;var k=p.attributes.getNamedItem("size").value;var b=o[g].attributes.getNamedItem("url");var m=b!=null?b.value:encodeURI(f+l).replace(/#/g,"%23");c.Append(oListManager.GetFileRowHtml(l,m,k))}c.Append("</table>");document.body.innerHTML=c.ToString()}window.onload=function(){window.top.IsLoadedResourcesList=true};</script></head><body class="FileArea"></body></html>