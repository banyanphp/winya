
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><title>Folders</title><link href="browser.css" type="text/css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><script type="text/javascript" src="js/common.js"></script><script type="text/javascript">var sActiveFolder;var bIsLoaded=false;var iIntervalId;var oListManager=new Object();oListManager.Init=function(){this.Table=document.getElementById("tableFiles");this.UpRow=document.getElementById("trUp");this.TableRows=new Object()};oListManager.Clear=function(){while(this.Table.rows.length>1){this.Table.deleteRow(1)}this.TableRows=new Object()};oListManager.AddItem=function(e,d){var b=this.Table.insertRow(-1);b.className="FolderListFolder";var a='<a href="#" onclick="OpenFolder(\'' + folderPath + '\');return false;">';var c=b.insertCell(-1);c.width=16;c.innerHTML=a+'<img alt="" src="images/spacer.gif" width="16" height="16" border="0"></a>';c=b.insertCell(-1);c.noWrap=true;c.innerHTML="&nbsp;"+a+e+"</a>";this.TableRows[d]=b};oListManager.ShowUpFolder=function(a){this.UpRow.style.display=(a!=null?"":"none");if(a!=null){document.getElementById("linkUpIcon").onclick=document.getElementById("linkUp").onclick=function(){LoadFolders(a);return false}}};function CheckLoaded(){if(window.top.IsLoadedActualFolder&&window.top.IsLoadedCreateFolder&&window.top.IsLoadedUpload&&window.top.IsLoadedResourcesList){window.clearInterval(iIntervalId);bIsLoaded=true;OpenFolder(sActiveFolder)}}function OpenFolder(a){sActiveFolder=a;if(!bIsLoaded){if(!iIntervalId){iIntervalId=window.setInterval(CheckLoaded,100)}return}for(var b in oListManager.TableRows){oListManager.TableRows[b].className=(b==a?"FolderListCurrentFolder":"FolderListFolder")}window.parent.frames.frmActualFolder.SetCurrentFolder(oConnector.ResourceType,a);window.parent.frames.frmCreateFolder.SetCurrentFolder(oConnector.ResourceType,a);window.parent.frames.frmUpload.SetCurrentFolder(oConnector.ResourceType,a);window.parent.frames.frmResourcesList.LoadResources(oConnector.ResourceType,a)}function LoadFolders(a){oListManager.Clear();var b;if(a!="/"){b=a.substring(0,a.lastIndexOf("/",a.length-2)+1)}oListManager.ShowUpFolder(b);if(a!="/"){sActiveFolder=a;oConnector.CurrentFolder=b;oConnector.SendCommand("GetFolders",null,GetFoldersCallBack)}else{OpenFolder("/")}}function GetFoldersCallBack(c){if(oConnector.CheckError(c)!=0){return}var f=c.SelectSingleNode("Connector/CurrentFolder");var d=f.attributes.getNamedItem("path").value;var e=c.SelectNodes("Connector/Folders/Folder");for(var b=0;b<e.length;b++){var a=e[b].attributes.getNamedItem("name").value;oListManager.AddItem(a,d+a+"/")}OpenFolder(sActiveFolder)}function SetResourceType(a){oConnector.ResourceType=a;LoadFolders("/")}window.onload=function(){oListManager.Init();LoadFolders("/")};</script></head><body class="FileArea"><table id="tableFiles" cellSpacing="0" cellPadding="0" width="100%" border="0"><tr id="trUp" style="DISPLAY: none"><td width="16"><a id="linkUpIcon" href="#"><img alt="" src="images/FolderUp.gif" width="16" height="16" border="0"></a></td><td nowrap width="100%">&nbsp;<a id="linkUp" href="#">..</a></td></tr></table></body></html>